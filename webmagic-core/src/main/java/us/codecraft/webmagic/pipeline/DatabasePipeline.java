package us.codecraft.webmagic.pipeline;

import us.codecraft.webmagic.ResultItems;
import us.codecraft.webmagic.Task;

import java.sql.*;

public class DatabasePipeline implements Pipeline{
    String[] colName = {"CveId","Desc","PublishDate","UpdateDate","Cvss","ConImpact","IntegImpact","AvaImpact","AccComplexity","Auth","GainAcc","VulnType","CweId","CweRef","AffectedEntity","Reference"};
    static Connection conn = DbUnit.getConn();

    @Override
    public void process(ResultItems resultItems, Task task) throws SQLException {
        String sql = "INSERT INTO cve VALUES(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?);";
        PreparedStatement ptmt = conn.prepareStatement(sql);
        for(int i=0;i<colName.length;i++){
            ptmt.setString(i+1,resultItems.get(colName[i]));
        }
        ptmt.execute();
    }
}
